<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="appTitle">ğŸ¼ å¥¶ç²‰æ²–æ³¡è¨ˆç®—æ©Ÿ (10å€æ•¸)</title>
    <style>
        /* åŸºç¤æ¨£å¼èˆ‡æ‰‹æ©Ÿå„ªåŒ– */
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #fce4ec; 
            color: #ad1457;
        }

        .calculator-container {
            background-color: #ffffff;
            padding: 25px;
            padding-top: 60px; /* **æ–°å¢ï¼šç‚ºå³ä¸Šè§’çš„æŒ‰éˆ•é ç•™ç©ºé–“** */
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
            position: relative; 
        }

        /* **** èªè¨€åˆ‡æ›æŒ‰éˆ•æ¨£å¼ä¿®æ­£ **** */
        #language-toggle {
            position: absolute;
            top: 15px; /* è·é›¢é ‚éƒ¨ 15px */
            right: 15px; /* è·é›¢å³é‚Š 15px */
            z-index: 10; /* ç¢ºä¿å®ƒåœ¨æœ€ä¸Šå±¤ */
            
            /* å°ºå¯¸å„ªåŒ– */
            padding: 5px 10px; 
            font-size: 0.8em; /* å­—é«”ç¸®å° */
            
            background-color: #d81b60;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #language-toggle:hover {
            background-color: #880e4f;
        }

        /* æ¨™é¡Œæ¨£å¼ */
        h1 {
            color: #880e4f;
            text-align: center;
            /* ç”±æ–¼ä¸Šæ–¹å·²ç¶“ç”¨ padding-top é¨°å‡ºç©ºé–“ï¼Œé€™è£¡çš„ margin å¯ä»¥æ¸›å°‘ */
            margin-top: 0; 
            margin-bottom: 30px; 
            font-size: 1.8em;
        }

        /* å…¶ä»–è¡¨å–®å…ƒç´ çš„æ¨£å¼... */
        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 1.1em;
            color: #c2185b;
        }

        select {
            width: 100%;
            padding: 12px 10px;
            border: 2px solid #f48fb1;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1.1em;
            background-color: #fce4ec;
            min-height: 48px; 
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        .select-wrapper {
            position: relative;
        }
        .select-wrapper::after {
            content: 'â–¼';
            font-size: 1em;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: #c2185b;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        button:not(#language-toggle) { /* æ’é™¤èªè¨€åˆ‡æ›æŒ‰éˆ• */
            width: 100%;
            padding: 15px;
            background-color: #ec407a;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        button:not(#language-toggle):hover {
            background-color: #d81b60;
        }

        /* çµæœé¡¯ç¤ºå€ */
        #result_area {
            margin-top: 30px;
            padding: 15px;
            border: 2px dashed #ec407a;
            border-radius: 8px;
            text-align: center;
            background-color: #fff8e1;
            min-height: 100px;
        }

        #result_area p {
            font-size: 1.1em;
            font-weight: bold;
            margin: 10px 0;
            color: #880e4f;
        }
        #result_area strong {
            font-size: 1.4em;
            color: #d32f2f;
        }
    </style>
</head>
<body>

    <div class="calculator-container">
        
        <button id="language-toggle" onclick="switchLanguage()">English</button>

        <h1 id="mainTitle">ğŸ‘¶ å¥¶ç²‰æ²–æ³¡æ°´é‡è¨ˆç®— (10ml å–®ä½)</h1>

        <div class="form-group">
            <label id="labelMilkAmount" for="milk_amount">ç¸½å¥¶é‡ (ml):</label>
            <div class="select-wrapper">
                <select id="milk_amount" name="milk_amount">
                    <option value="120">120 ml</option>
                    <option value="150">150 ml</option>
                    <option value="180" selected>180 ml</option>
                    <option value="210">210 ml</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label id="labelHotWater" for="hot_water_temp">ç†±æ°´æº«åº¦ (â„ƒ):</label>
            <div class="select-wrapper">
                <select id="hot_water_temp" name="hot_water_temp">
                    <option value="70">70 â„ƒ</option>
                    <option value="80" selected>80 â„ƒ</option>
                    <option value="90">90 â„ƒ</option>
                    <option value="100">100 â„ƒ</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label id="labelColdWater" for="cold_water_temp">å†·æ°´æº«åº¦ (â„ƒ):</label>
            <div class="select-wrapper">
                <select id="cold_water_temp" name="cold_water_temp">
                    <option value="16">16 â„ƒ</option>
                    <option value="18">18 â„ƒ</option>
                    <option value="20" selected>20 â„ƒ</option>
                    <option value="22">22 â„ƒ</option>
                    <option value="24">24 â„ƒ</option>
                    <option value="26">26 â„ƒ</option>
                </select>
            </div>
        </div>

        <button id="calculateButton" onclick="calculateWaterAmount()">
            è¨ˆç®—æœ€ä½³ 10ml å€æ•¸é…æ¯”
        </button>
        
        <div id="result_area">
            <p id="initialPrompt">è«‹é¸æ“‡ä¸Šæ–¹åƒæ•¸ä¸¦é»æ“Šã€Œè¨ˆç®—ã€</p>
        </div>
        
    </div>

    <script>
        // --- JavaScript ä¿æŒä¸è®Š ---
        const languageData = {
            'zh': {
                appTitle: 'ğŸ¼ å¥¶ç²‰æ²–æ³¡è¨ˆç®—æ©Ÿ (10å€æ•¸)',
                mainTitle: 'ğŸ‘¶ å¥¶ç²‰æ²–æ³¡æ°´é‡è¨ˆç®— (10ml å–®ä½)',
                labelMilkAmount: 'ç¸½å¥¶é‡ (ml):',
                labelHotWater: 'ç†±æ°´æº«åº¦ (â„ƒ):',
                labelColdWater: 'å†·æ°´æº«åº¦ (â„ƒ):',
                calculateButton: 'è¨ˆç®—æœ€ä½³ 10ml å€æ•¸é…æ¯”',
                initialPrompt: 'è«‹é¸æ“‡ä¸Šæ–¹åƒæ•¸ä¸¦é»æ“Šã€Œè¨ˆç®—ã€',
                resultBest: 'æœ€ä½³èª¿é…çµæœ (10ml å–®ä½):',
                resultHot: 'ç†±æ°´ ({temp}â„ƒ) éœ€è¦ï¼š',
                resultCold: 'å†·æ°´ ({temp}â„ƒ) éœ€è¦ï¼š',
                resultActualTemp: 'æ··åˆå¾Œå¯¦éš›æº«åº¦ç´„ï¼š',
                resultRangeNote: '(è½åœ¨ç›®æ¨™ç¯„åœ {min}~{max}â„ƒ å…§)',
                errorCannotMixTitle: 'âŒ éŒ¯èª¤',
                errorCannotMixMsg: 'æ‚¨çš„ç†±æ°´ ({Th}â„ƒ) æˆ–å†·æ°´ ({Tc}â„ƒ) ç„¡æ³•èª¿é…å‡º {min}~{max}â„ƒ çš„æ°´ã€‚',
                errorNo10xTitle: 'âš ï¸ æ³¨æ„',
                errorNo10xMsg: 'åœ¨ 10ml å€æ•¸çš„é™åˆ¶ä¸‹ï¼Œæ‰¾ä¸åˆ°èƒ½æº–ç¢ºè½åœ¨ {min}~{max}â„ƒ ç¯„åœå…§çš„çµ„åˆã€‚',
                errorNo10xHint: 'è«‹å˜—è©¦æ›´æ”¹ç†±æ°´æˆ–å†·æ°´çš„æº«åº¦è¨­å®šã€‚'
            },
            'en': {
                appTitle: 'ğŸ¼ Formula Water Calculator (10x Multiples)',
                mainTitle: 'ğŸ‘¶ Formula Water Calculation (10ml Units)',
                labelMilkAmount: 'Total Volume (ml):',
                labelHotWater: 'Hot Water Temp. (â„ƒ):',
                labelColdWater: 'Cold Water Temp. (â„ƒ):',
                calculateButton: 'Calculate Optimal 10ml Ratio',
                initialPrompt: 'Please select parameters and click "Calculate"',
                resultBest: 'Optimal Mixing Ratio (10ml units):',
                resultHot: 'Hot Water ({temp}â„ƒ) required:',
                resultCold: 'Cold Water ({temp}â„ƒ) required:',
                resultActualTemp: 'Actual Mixed Temp. approx.:',
                resultRangeNote: '(Within target range {min}~{max}â„ƒ)',
                errorCannotMixTitle: 'âŒ Error',
                errorCannotMixMsg: 'Your hot water ({Th}â„ƒ) or cold water ({Tc}â„ƒ) cannot mix water between {min}~{max}â„ƒ.',
                errorNo10xTitle: 'âš ï¸ Warning',
                errorNo10xMsg: 'No 10ml multiple combination found to be accurately within the {min}~{max}â„ƒ range.',
                errorNo10xHint: 'Please try changing the hot or cold water temperature settings.'
            }
        };

        let currentLang = 'zh'; 

        function switchLanguage() {
            currentLang = (currentLang === 'zh') ? 'en' : 'zh';
            const lang = languageData[currentLang];
            
            document.getElementById('appTitle').textContent = lang.appTitle;
            document.getElementById('mainTitle').textContent = lang.mainTitle;
            document.getElementById('labelMilkAmount').textContent = lang.labelMilkAmount;
            document.getElementById('labelHotWater').textContent = lang.labelHotWater;
            document.getElementById('labelColdWater').textContent = lang.labelColdWater;
            document.getElementById('calculateButton').textContent = lang.calculateButton;
            
            document.getElementById('language-toggle').textContent = (currentLang === 'zh') ? 'English' : 'ä¸­æ–‡';
            
            calculateWaterAmount(true); 
        }

        function calculateWaterAmount(isLanguageSwitch = false) {
            const totalVolume = parseInt(document.getElementById('milk_amount').value);
            const Th = parseInt(document.getElementById('hot_water_temp').value);
            const Tc = parseInt(document.getElementById('cold_water_temp').value);
            const T_min = 42;
            const T_max = 48;
            const T_ideal = 45;
            const resultArea = document.getElementById('result_area');
            const lang = languageData[currentLang];

            if (isLanguageSwitch && resultArea.innerHTML.includes('initialPrompt')) {
                resultArea.innerHTML = `<p id="initialPrompt">${lang.initialPrompt}</p>`;
                return;
            }

            let bestVh = 0;
            let bestVc = 0;
            let closestTemp = 0;
            let minTempDiff = Infinity; 

            if (T_min < Tc || T_max > Th) {
                let errorMsg = lang.errorCannotMixMsg.replace('{Th}', Th).replace('{Tc}', Tc).replace('{min}', T_min).replace('{max}', T_max);
                resultArea.innerHTML = `<p style="color:#d32f2f;">${lang.errorCannotMixTitle}</p>
                                        <p>${errorMsg}</p>`;
                return;
            }

            for (let Vh_try = 10; Vh_try < totalVolume; Vh_try += 10) {
                const Vc_try = totalVolume - Vh_try;
                if (Vc_try % 10 !== 0) continue; 
                
                const Tm_actual = (Vh_try * Th + Vc_try * Tc) / totalVolume;

                if (Tm_actual >= T_min && Tm_actual <= T_max) {
                    const tempDiff = Math.abs(Tm_actual - T_ideal);
                    
                    if (tempDiff < minTempDiff) {
                        minTempDiff = tempDiff;
                        bestVh = Vh_try;
                        bestVc = Vc_try;
                        closestTemp = Tm_actual;
                    }
                }
            }

            if (bestVh > 0) {
                let note = lang.resultRangeNote.replace('{min}', T_min).replace('{max}', T_max);
                let hotLabel = lang.resultHot.replace('{temp}', Th);
                let coldLabel = lang.resultCold.replace('{temp}', Tc);

                resultArea.innerHTML = `
                    <p>${lang.resultBest}</p>
                    <hr style="border-color: #ec407a;">
                    <p>${hotLabel}<strong>${bestVh} ml</strong></p>
                    <p>${coldLabel}<strong>${bestVc} ml</strong></p>
                    <p style="font-size:1em; color:#d32f2f;">
                        ${lang.resultActualTemp}<strong>${closestTemp.toFixed(1)} â„ƒ</strong>
                    </p>
                    <p style="font-size:0.9em; color:#757575;">${note}</p>
                `;
            } else {
                 let errorMsg = lang.errorNo10xMsg.replace('{min}', T_min).replace('{max}', T_max);
                resultArea.innerHTML = `<p style="color:#d32f2f;">${lang.errorNo10xTitle}</p>
                                        <p>${errorMsg}</p>
                                        <p style="font-size:0.9em;">${lang.errorNo10xHint}</p>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            switchLanguage(); 
            switchLanguage(); 
        });
    </script>

</body>
</html>
